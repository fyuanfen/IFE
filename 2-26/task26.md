# 行星与飞船

## 任务描述

创建一个虚拟宇宙，包括一个行星和飞船，

1. 飞船由以下部分组成：

- 动力系统，可以完成飞行和停止飞行两个行为，暂定所有飞船的动力系统飞行速度是一致的，比如每秒20px，飞行过程中会按照一定速率消耗能源（比如每秒减5%）
- 能源系统，提供能源，并且在宇宙中通过太阳能充电（比如每秒增加2%，具体速率自定）
- 信号接收处理系统，用于接收行星上的信号
- 自爆系统，用于自我销毁

每个飞船的能源是有限的，用一个属性来表示能源剩余量，这是一个百分比，表示还剩余多少能源。
能源耗尽时，飞船会自动停止飞行

飞船有两个状态：飞行中和停止，飞船的行为会改变这个属性状态

飞船的自我销毁方法会立即销毁飞船自身

2. 行星上有一个指挥官，指挥官可以通过行星上的信号发射器发布如下命令：
- 创建一个新的飞船进入轨道，最多可以创建4个飞船，刚被创建的飞船会停留在某一个轨道上静止不动
- 命令某个飞船开始飞行，飞行后飞船会围绕行星做环绕运动，需要模拟出这个动画效果
- 命令某个飞船停止飞行
- 命令某个飞船销毁，销毁后飞船消失、飞船标示可以用于下次新创建的飞船

你需要设计类似如下指令格式的数据格式

```javascript
			{
				id: 1,
				commond: 'stop'
			}
```		

3. 指挥官通过信号发射器发出的命令是通过一种叫做Mediator的介质进行广播

Mediator是单向传播的，只能从行星发射到宇宙中，在发射过程中，有30%的信息传送失败（丢包）概率，你需要模拟这个丢包率，另外每次信息正常传送的时间需要1秒

指挥官并不知道自己的指令是不是真的传给了飞船，飞船的状态他是不知道的，他只能通过自己之前的操作来假设飞船当前的状态

每个飞船通过信号接收器，接受到通过Mediator传达过来的指挥官的广播信号，但因为是广播信号，所以每个飞船能接受到指挥官发出给所有飞船的所有指令，因此需要通过读取信息判断这个指令是不是发给自己的

解析：
由任务描述可知，该系统主要分为三个模块

1. 指挥官commander
该模块为单例模式
实现如下：
```javascript
var commander = function () {

    /* 这里声明私有变量和方法 */
    var privateVariable = 'something private';
    function showPrivate() {
        console.log(privateVariable);
    }

    /* 公有变量和方法（可以访问私有变量和方法） */
    return {
        publicMethod: function () {
            showPrivate();
        },
        publicVar: 'the public can see this!'
    };
};
```
var single = mySingleton();
single.publicMethod();  // 输出 'something private'
console.log(single.publicVar); // 输出 'the public can see this!'


## 系统实现
## spaceCraft是飞船对象
包含飞船自身的充电能源系数energySystem，消耗动力系数energyConsume

通过控制飞船所在父元素方块的transform属性，控制飞船的旋转速度

spaceCraft是单例对象，通过Object.create()方法，使用寄生模式继承飞船对象。

之后增强相关属性，添加私有变量order保存轨道信息和公有方法signalSystem接受广播的命令，并执行相应操作
## commander是指挥官
负责命令的生成，并传递给广播mediator，具体结构如下：

1. 私有变量spaceCraft，保存指挥官设定的飞船的状态变量。由于命令在广播时有30%丢包的几率，因此与飞船实际状态不一定一致。

2. 添加飞船。启动，停止，销毁飞船。

## mediator是命令的广播介质
spaceCraft 记录飞船的实际状态（飞船所在轨道，飞船id）
控制台的信息数组
飞船的总体id号

- renderCrafts(crafts)：根据spaceCraft中存放的飞船，按照他们所在的轨道order逐个渲染界面
crafts数组中的飞船保存格式为（飞船对象craft，飞船id），其中飞船对象craft中包含飞船的所在轨道和操作方法

首先要判断需要渲染的飞船所在的轨道，有没有与他id相同的飞船，如果没有就生成一个飞船的dom对象，并添加到页面的轨道节点中

